(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const c=e=>{try{return JSON.parse(localStorage.getItem(e))}catch{return null}},a=e=>localStorage.removeItem(e);function f(){a("token"),a("profile")}const u="https://api.noroff.dev/api/v1/auction",m=`${u}/listings`,g=e=>{const t=c("token"),o={};return e&&(o["Content-Type"]=e),t&&(o.Authorization=`Bearer ${t}`),o},d=document.getElementById("listingsContainer");function l(e){d.innerHTML="",e&&e.forEach(t=>d.innerHTML+=`<a href="/listing.html?id=${t.id}">
        <img src="${t.media}"/>
        <p>${t.title}</p>
        <p>Ends at ${t.endsAt}</p>
        </a>`)}function p(e){const t=document.getElementById("search");t.onkeyup=function(o){const i=o.target.value.trim().toLowerCase(),n=e.filter(r=>{if(r.title.toLowerCase().includes(i)||r.tags.toString().toLowerCase().includes(i))return!0});l(n)}}function y(e){const t=document.getElementById("filterRecent");t.onclick=function(){const o=new Date(new Date().setDate(new Date().getDate()-2)).toISOString(),i=e.filter(n=>n.created>=o);console.log(i),l(i)}}function h(e){const t=document.getElementById("filterPopular");t.onclick=function(){const o=e.filter(i=>i._count.bids>=10);console.log(o),l(o)}}async function L(){try{const e={method:"GET",headers:g("application/json"),body:JSON.stringify()},t=await fetch(`${m}?_active=true`,e);if(t.ok){const o=await t.json();l(o),p(o),y(o),h(o)}else alert("oops! something went wrong!")}catch(e){console.log(e)}}async function w(){document.getElementById("home").addEventListener("click",e=>{e.preventDefault();const t=c("profile");window.location=`/index.html?name=${t.name}`}),document.getElementById("registerBtn").addEventListener("click",e=>{e.preventDefault(),window.location="/register.html"}),document.getElementById("loginBtn").addEventListener("click",e=>{e.preventDefault(),window.location="/login.html"}),document.getElementById("createBtn").addEventListener("click",e=>{e.preventDefault();const t=c("profile");window.location=`/createListing.html?name=${t.name}`}),document.getElementById("profile").addEventListener("click",e=>{e.preventDefault();const t=c("profile");window.location=`/profile.html?name=${t.name}`}),document.getElementById("logoutBtn").addEventListener("click",e=>{e.preventDefault(),f(),location.href="/"})}async function v(){L()}w();v();listing();
